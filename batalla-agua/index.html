<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Batalla de Agua Animada</title>
  <style>
    body {
      margin: 0;
      background: #cceeff;
      overflow: hidden;
    }

    .escenario {
      position: relative;
      width: 100vw;
      height: 100vh;
    }

    .personaje {
      position: absolute;
      width: 150px;
    }

    #p1 {
      left: 50px;
      bottom: 50px;
      cursor: pointer;
    }

    #p2 {
      right: 50px;
      bottom: 50px;
      cursor: pointer;
    }

    .animacion {
      position: absolute;
      width: 100px;
      image-rendering: pixelated;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div class="escenario">
    <img id="p1" class="personaje" src="imagenes/personaje1.png" alt="P1">
    <img id="p2" class="personaje" src="imagenes/personaje2.png" alt="P2">
    <img id="anim" class="animacion" style="display:none">
  </div>

  <script>
    const p1 = document.getElementById("p1");
    const p2 = document.getElementById("p2");
    const anim = document.getElementById("anim");
    let enAnimacion = false;

    // Función principal de ataque
    function atacar(atacante, receptor, tipo) {
      if (enAnimacion) return;
      enAnimacion = true;

      const origen = atacante.getBoundingClientRect();
      const destino = receptor.getBoundingClientRect();

      // Determinar tipo de ataque y mojado
      const ataquePrefix = tipo === 1 ? "Ataque1_" : "Ataque2_";
      const mojadoPrefix = tipo === 1 ? "mojado2_" : "mojado1_";
      const totalFramesAtaque = 13;
      const totalFramesMojado = 14;

      let frame = 1;
      anim.style.left = `${origen.left + 60}px`;
      anim.style.top = `${origen.top}px`;
      anim.style.display = "block";

      const dx = (destino.left - origen.left) / totalFramesAtaque;
      const dy = (destino.top - origen.top) / totalFramesAtaque;

      // Reproducir ataque
      const ataqueInterval = setInterval(() => {
        const num = String(frame).padStart(4, "0");
        anim.src = `imagenes/${ataquePrefix}${num}.png`;
        anim.style.left = `${origen.left + dx * frame}px`;
        anim.style.top = `${origen.top + dy * frame}px`;
        frame++;
        if (frame > totalFramesAtaque) {
          clearInterval(ataqueInterval);
          mostrarMojado(mojadoPrefix, receptor, totalFramesMojado);
        }
      }, 60); // velocidad del ataque
    }

    // Mostrar animación de mojado
    function mostrarMojado(prefix, receptor, totalFrames) {
      let frame = 1;
      const mostrarInterval = setInterval(() => {
        const num = String(frame).padStart(4, "0");
        receptor.src = `imagenes/${prefix}${num}.png`;
        frame++;
        if (frame > totalFrames) {
          clearInterval(mostrarInterval);
          anim.style.display = "none";
          receptor.src = prefix.includes("mojado2") ? "imagenes/personaje2.png" : "imagenes/personaje1.png";
          enAnimacion = false;
        }
      }, 80); // velocidad del mojado
    }

    // Eventos de clic
    p1.addEventListener("click", () => atacar(p1, p2, 1));
    p2.addEventListener("click", () => atacar(p2, p1, 2));
  </script>
</body>
</html>
